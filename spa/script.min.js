"use strict";function _typeof(e){return e&&typeof Symbol!="undefined"&&e.constructor===Symbol?"symbol":typeof e}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(i,s){try{var o=t[i](s),u=o.value}catch(a){n(a);return}if(!o.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}return r("next")})}}!window.preloadedScripts && (window.preloadedScripts=[]);Array.prototype.push.apply(window.preloadedScripts,['spa/bigLoader.jsx','spa/index/controller.jsx','spa/index/style.min.css','spa/index/view.jsx','spa/info/controller.jsx','spa/info/style.min.css','spa/info/view.jsx','spa/loader.jsx','spa/status/controller.jsx','spa/status/style.min.css','spa/status/view.jsx','spa/switch/controller.jsx','spa/switch/style.min.css','spa/switch/view.jsx']);var BigLoader=React.createClass({displayName:"BigLoader",getDefaultSubscriptions:function(){var t=this;return{"loader/show":function(){return t.setState({propagate:!1,transaction:0,chunks:0},function(){return t.domRoot.css("display","block")})},"loader/propagate":this.propagate,"loader/hide":this.hideLoader,"loader/transaction":this.transaction,"loader/chunks":function(n){return t.setState({propagate:!1,transaction:0,chunks:n},function(){return t.domRoot.css("display","block")})}}},getInitialState:function(){return{counter:60}},propagate:function(t,n){var r=this;t&&t.forEach(function(e){return window.AJAXRequest(e.split("ipfs://").join("//gateway.ipfs.io/"))});var i=function(){if(r.state.counter===0)return r.interval&&clearInterval(r.interval),n&&n();r.setState({counter:r.state.counter-1,chunks:0})};r.interval&&clearInterval(r.interval),r.setState({counter:60,propagate:!0,transaction:0,chunks:0},function(){r.domRoot.css("display","block"),r.interval=setInterval(i,1e3)})},hideLoader:function(){this.interval&&clearInterval(this.interval),this.domRoot.css("display","none"),this.setState({propagate:!1,transaction:0,chunks:0})},transaction:function(t,n){this.interval&&clearInterval(this.interval),this.setState({transaction:t,transactions:n,propagate:!1,chunks:0})},render:function(){return React.createElement("section",{className:"UPLOADBANNER"},this.state.chunks&&React.createElement("h1",null,"Generating ",this.state.chunks," chunks..."),!this.state.chunks&&!this.state.propagate&&!this.state.transaction&&React.createElement("h1",null,this.props.message!==undefined&&this.props.message!==null?this.props.message:"Loading..."),!this.state.chunks&&this.state.propagate&&React.createElement("h1",null,this.state.counter),!this.state.chunks&&this.state.propagate&&React.createElement("h2",null,"Waiting for Propagation"),!this.state.chunks&&this.state.transaction&&React.createElement("h2",null,"Transaction ",this.state.transaction," ",this.state.transactions>1&&React.createElement("span",null,"of ",this.state.transactions)),React.createElement("div",{"class":"loadingio-spinner-ripple-6l4nh0xpwdg"},React.createElement("div",{"class":"ldio-2it1sjbil3o"},React.createElement("div",null),React.createElement("div",null))))}});var IndexController=function(t){var n=this;n.view=t,n.loadData=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t,i,s,o,u,a,f,l,c;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.t0=n.view,h.t1=window.newToken.token.options.address,h.next=4,n.loadSupplies(window.newToken.token,window.context.newTokenExcludeAddresses);case 4:return h.t2=h.sent,h.next=7,n.loadSupplies(window.oldToken.token,window.context.oldTokenExcludeAddresses);case 7:return h.t3=h.sent,h.t4={newVotingTokenAddress:h.t1,newVotingTokenSupply:h.t2,oldVotingTokenSupply:h.t3},h.t0.setState.call(h.t0,h.t4),h.t5=parseInt,h.next=13,window.web3.eth.getBlockNumber();case 13:return h.t6=h.sent,e=(0,h.t5)(h.t6),h.t7=parseInt,h.next=18,window.blockchainCall(window.vasaPowerSwitch.methods.startBlock);case 18:h.t8=h.sent,t=(0,h.t7)(h.t8);if(window.walletAddress){h.next=24;break}h.t9=!1,h.next=30;break;case 24:return h.t10=parseInt,h.next=27,window.blockchainCall(window.oldToken.token.methods.allowance,window.walletAddress,window.vasaPowerSwitch.options.address);case 27:h.t11=h.sent,h.t12=(0,h.t10)(h.t11),h.t9=h.t12>0;case 30:i=h.t9;if(window.walletAddress){h.next=35;break}h.t13="0",h.next=38;break;case 35:return h.next=37,window.blockchainCall(window.oldToken.token.methods.balanceOf,window.walletAddress);case 37:h.t13=h.sent;case 38:return s=h.t13,h.next=41,window.blockchainCall(window.vasaPowerSwitch.methods.totalMintable);case 41:return o=h.sent,n.view.setState({startBlock:t,currentBlock:e,approved:i,balanceOf:s,totalMintable:o}),h.next=45,window.blockchainCall(window.vasaPowerSwitch.methods.length);case 45:u=h.sent,a=[],f=null,l=0;case 49:if(!(l<u)){h.next=58;break}return h.next=52,window.blockchainCall(window.vasaPowerSwitch.methods.timeWindow,l);case 52:c=h.sent,a.push(c),e>=t&&!f&&e<=parseInt(c[0])&&(f=c);case 55:l++,h.next=49;break;case 58:n.view.setState({slots:a,currentSlot:f});case 59:case"end":return h.stop()}},r,this)}));return t}(),n.loadSupplies=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e,t){var r,i,s,o,u,a;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.t0=window.web3.utils,f.next=4,window.blockchainCall(e.methods.totalSupply);case 4:f.t1=f.sent,r=f.t0.toBN.call(f.t0,f.t1);if(!(t&&t.length>0)){f.next=28;break}i=t,s=Array.isArray(i),o=0,i=s?i:i[Symbol.iterator]();case 8:if(!s){f.next=14;break}if(!(o>=i.length)){f.next=11;break}return f.abrupt("break",28);case 11:u=i[o++],f.next=18;break;case 14:o=i.next();if(!o.done){f.next=17;break}return f.abrupt("break",28);case 17:u=o.value;case 18:return a=u,f.t2=r,f.t3=window.web3.utils,f.next=23,window.blockchainCall(e.methods.balanceOf,a);case 23:f.t4=f.sent,f.t5=f.t3.toBN.call(f.t3,f.t4),r=f.t2.sub.call(f.t2,f.t5);case 26:f.next=8;break;case 28:return f.abrupt("return",r.toString());case 31:return f.prev=31,f.t6=f["catch"](0),f.abrupt("return","0");case 34:case"end":return f.stop()}},n,this,[[0,31]])}));return t}()};var Index=React.createClass({displayName:"Index",requiredModules:["spa/info"],requiredScripts:["spa/bigLoader.jsx","spa/loader.jsx"],getInitialState:function(){return{element:"Info"}},getDefaultSubscriptions:function(){return{"ethereum/ping":this.controller.loadData}},onClick:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.changeView(t.currentTarget.innerHTML)},changeView:function(t){var n=this;this.domRoot.children().find("a").removeClass("selected").each(function(e,n){if(n.innerHTML.toLowerCase()===t.toLowerCase())return $(n).addClass("selected")}),ReactModuleLoader.load({modules:["spa/"+t.toLowerCase()],callback:function(){n.setState({element:t})}})},componentDidMount:function(){this.controller.loadData()},render:function(){var t={};return this.props&&Object.entries(this.props).forEach(function(e){return t[e[0]]=e[1]}),this.state&&Object.entries(this.state).forEach(function(e){return t[e[0]]=e[1]}),t.props&&Object.entries(t.props).forEach(function(e){return t[e[0]]=e[1]}),delete t.props,React.createElement("section",{className:"OnePage"},React.createElement("header",{className:"Head"},React.createElement("section",{className:"HBrand"},React.createElement("h6",null,"$",window.newToken.symbol," Switch")),React.createElement("section",{className:"HActions"},React.createElement("a",{href:window.dfo.ens,target:"_blank"},"#",window.newToken.name),React.createElement("a",{href:window.context.gitHubURL,target:"_blank"},"#github"),React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"address/"+window.vasaPowerSwitch.options.address,target:"_blank"},"#etherscan"))),React.createElement("section",{className:"PagerMenu"},React.createElement("ul",{className:"Menu"},React.createElement("a",{href:"javascript:;",className:"InfoOpener selected",onClick:this.onClick},"Info"),React.createElement("a",{href:"javascript:;",className:"SwitchOpener",onClick:this.onClick},"Switch"),React.createElement("a",{href:"javascript:;",className:"StakeOpener",onClick:this.onClick},"Status"))),!t.slots&&[React.createElement("br",null),React.createElement(Loader,null)],t.slots&&React.createElement(window[this.state.element],t))}});var InfoController=function(t){var n=this;n.view=t};var Info=React.createClass({displayName:"Info",requiredScripts:["spa/bigLoader.jsx"],render:function(){return React.createElement("section",null,React.createElement("section",{className:"ExpTop"},React.createElement("h1",null,"Welcome to the $",window.newToken.symbol," Switch manager"),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"Here you can migrate the old ",React.createElement("b",null,"$",window.oldToken.symbol," V1")," Governance Token of ",window.newToken.name," ",React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"token/"+window.oldToken.address,target:"_blank"},window.oldToken.address)," to the new ",React.createElement("b",null,"$",window.newToken.symbol," V2")," ",React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"token/"+this.props.newVotingTokenAddress,target:"_blank"},this.props.newVotingTokenAddress))),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,React.createElement("b",null,"Disclamer:")," Before trusting this website, make sure the URL is ",React.createElement("a",{href:window.context.switchWebsite,target:"_blank"},window.context.switchWebsite))),React.createElement("h2",null,"This is the only official Switch service supported by the ",window.newToken.name," Team."),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,React.createElement("a",{href:window.context.switchWebsite,target:"_blank"},window.context.switchWebsite)," is an easy procedure to receive new $",window.newToken.symbol," V2 Voting tokens, by burning old one $",window.oldToken.symbol," V1 tokens.")),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"To receive your $",window.newToken.symbol," V2 tokens—burning your $",window.oldToken.symbol,' V1 tokens in the process—all you need to do is navigate to the "Switch" section of this site, and follow these steps:  ')),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"#1 Set the amount of $",window.oldToken.symbol," V1 you wish to switch."),React.createElement("p",null,'#2 Approve the Switch by clicking the "Approve" button.'),React.createElement("p",null,"#3 Approve the transaction via your Web 3 provider (Metamask, TrustWallet, etc.). "),React.createElement("p",null,'#4 Start the Switch by clicking the "Switch" button.'),React.createElement("p",null,"#5 Approve the Ethereum transaction via your Web 3 provider (Metamask, TrustWallet, etc.)."),React.createElement("p",null,"#6 You’re done! Just wait for the Ethereum Transaction to complete, and the $",window.newToken.symbol," V2 tokens will be in your wallet!")),React.createElement("h2",null,"Incentives"),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,'During the Switch period, there are some bonuses for early switchers. You can find all information about this and the flippening in the "Status" section of this site. ')),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,React.createElement("b",null,"Disclamer:")," $",window.oldToken.symbol," V1 will not be supported by the ",window.newToken.name," team after 1st August 2020.")),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,React.createElement("b",null,"Disclamer:")," Switching $",window.oldToken.symbol," V1 to $",window.newToken.symbol," V2 is an irreversible action. Do it at your own risk."))))}});var Loader=React.createClass({displayName:"Loader",render:function(){return React.createElement("div",{className:"loadingio-spinner-square-iyrjry8g9g9"},React.createElement("div",{className:"ldio-wdnt6erfulc"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null)))}});var StatusController=function(t){var n=this;n.view=t};var Status=React.createClass({displayName:"Status",requiredScripts:["spa/loader.jsx","spa/bigLoader.jsx"],render:function(){var t=this,n={};return n&&Object.entries(n).forEach(function(e){return n[e[0]]=e[1]}),this.state&&Object.entries(this.state).forEach(function(e){return n[e[0]]=e[1]}),n.props&&Object.entries(n.props).forEach(function(e){return n[e[0]]=e[1]}),delete n.props,React.createElement("section",null,React.createElement("section",{className:"statusBox"},React.createElement("h2",null,"Flippening Watch"),React.createElement("section",{className:"statusTitle"},React.createElement("section",{className:"statusFlip"},React.createElement("img",{src:window.oldToken.logo}),React.createElement("a",null,"$",window.oldToken.symbol," V1"),React.createElement("h3",null,window.fromDecimals(this.props.oldVotingTokenSupply,18)),React.createElement("h6",null,"Circulating Supply")),React.createElement("section",{className:"statusFlip"},React.createElement("img",{src:window.newToken.logo}),React.createElement("a",null,"$",window.oldToken.symbol," V2"),React.createElement("h3",null,window.fromDecimals(this.props.newVotingTokenSupply,18)),React.createElement("h6",null,"Circulating Supply")))),React.createElement("section",{className:"statusBox"},React.createElement("h2",null,"Switch Status:"),this.props&&this.props.currentBlock<this.props.startBlock&&[React.createElement("h3",null,"Start Block: ",React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"block/"+this.props.startBlock,target:"_blank"},this.props.startBlock)),React.createElement("br",null)],React.createElement("ul",null,this.props.slots&&this.props.slots.map(function(e,n){return React.createElement("li",{key:n},React.createElement("h1",null,"x ",window.numberToString(parseInt(e[1])/parseInt(e[2]))),React.createElement("h5",null,"End Block: ",React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"block/"+e[0],target:"_blank"},e[0])),React.createElement("h5",null,"Status: "," "," ",React.createElement("a",{className:t.props.slots.indexOf(t.props.currentSlot)===n?"Active":t.props.currentBlock<t.props.startBlock||t.props.currentSlot&&t.props.slots.indexOf(t.props.currentSlot)<n?"Next":"Ended"},t.props.slots.indexOf(t.props.currentSlot)===n?"Active":t.props.currentBlock<t.props.startBlock||t.props.currentSlot&&t.props.slots.indexOf(t.props.currentSlot)<n?"Next":"Ended")))}))))}});var SwitchController=function(t){var n=this;n.view=t,n.switchOperation=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(isNaN(parseFloat(e))||parseFloat(e)<0)){r.next=2;break}return r.abrupt("return",alert("Please, insert an amount greater than zero"));case 2:return e=window.toDecimals(e,18),r.t0=parseInt(e),r.t1=parseInt,r.next=7,n.getBalanceOf();case 7:r.t2=r.sent,r.t3=(0,r.t1)(r.t2);if(!(r.t0>r.t3)){r.next=11;break}return r.abrupt("return",alert("Inserted value is greater than your actual balance"));case 11:return r.prev=11,r.next=14,window.blockchainCall(window.vasaPowerSwitch.methods.vasaPowerSwitch,e);case 14:n.view.emit("ethereum/ping"),r.next=20;break;case 17:return r.prev=17,r.t4=r["catch"](11),r.abrupt("return",alert(r.t4.message||r.t4));case 20:case"end":return r.stop()}},r,this,[[11,17]])}));return t}(),n.getBalanceOf=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.blockchainCall(window.oldToken.token.methods.balanceOf,window.walletAddress);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},n,this)}));return t}(),n.approve=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=window,t.t1=window.oldToken.token.methods.approve,t.t2=window.vasaPowerSwitch.options.address,t.next=5,window.blockchainCall(window.oldToken.token.methods.totalSupply);case 5:return t.t3=t.sent,t.next=8,t.t0.blockchainCall.call(t.t0,t.t1,t.t2,t.t3);case 8:n.view.emit("ethereum/ping");case 9:case"end":return t.stop()}},r,this)}));return t}()};var Switch=React.createClass({displayName:"Switch",requiredScripts:["spa/loader.jsx","spa/bigLoader.jsx"],max:function(){var t=this;window.walletAddress&&this.props.balanceOf&&this.controller.getBalanceOf().then(function(e){return t.input.value=window.fromDecimals(e,18,!0)}),this.onChange()},approve:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if(t.currentTarget.className.indexOf("active")===-1)return;this.controller.approve()},"switch":function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if(t.currentTarget.className.indexOf("active")===-1)return;this.controller.switchOperation(this.input.value)},onChange:function(){if(!this.input||!this.switchFinal)return;this.switchFinal.innerHTML="0";var t=this.input.value;if(isNaN(parseInt(t)))return;if(!this.props.currentSlot)return;t=window.toDecimals(t,18),t=window.web3.utils.toBN(t).mul(window.web3.utils.toBN(this.props.currentSlot[1])).div(window.web3.utils.toBN(this.props.currentSlot[2])),this.switchFinal.innerHTML=window.fromDecimals(t,18)},render:function(){var t=this,n=this;return React.createElement("section",null,React.createElement("section",{className:"switchBox"},React.createElement("h3",null,"Switch"),React.createElement("section",{className:"switchTools"},React.createElement("a",{href:"javascript:;",className:"switchAll",onClick:this.max},"Max"),React.createElement("input",{type:"number",ref:function(n){return(t.input=n)&&(n.value=window.fromDecimals(t.props.balanceOf,18))&&t.onChange()},onChange:this.onChange}),React.createElement("a",{className:"switchLink",href:window.getNetworkElement("etherscanURL")+"token/"+window.oldToken.token.options.address,target:"_blank"},"$",window.oldToken.symbol,React.createElement("b",null," V1")),React.createElement("img",{src:window.oldToken.logo})),React.createElement("h3",null,"For"),React.createElement("section",{className:"switchTools"},React.createElement("span",{ref:function(n){return(t.switchFinal=n)&&t.onChange()},className:"switchFinal"},"0"),React.createElement("a",{className:"switchLink",href:window.getNetworkElement("etherscanURL")+"token/"+this.props.newVotingTokenAddress,target:"_blank"},"$",window.newToken.symbol,React.createElement("b",null," V2")),React.createElement("img",{src:window.newToken.logo})),React.createElement("section",{className:"switchActions"},!this.props.currentSlot&&React.createElement(Loader,null),this.props.currentSlot&&window.walletAddress&&React.createElement("a",{href:"javascript:;",className:"switchAction"+(this.props.approved?"":" active"),onClick:this.approve},"Approve"),this.props.currentSlot&&window.walletAddress&&React.createElement("a",{href:"javascript:;",className:"switchAction"+(this.props.approved?" active":""),onClick:this.switch},"Switch"),this.props.currentSlot&&!window.walletAddress&&React.createElement("a",{href:"javascript:;",onClick:function(){return window.ethereum.enable().then(function(){return window.getAddress()}).then(function(){return n.emit("ethereum/ping")})},className:"switchAction active"},"Connect")),this.props.currentSlot&&React.createElement("p",null,"Current Switch bonus is ",React.createElement("b",null,"X",window.numberToString(parseInt(this.props.currentSlot[1])/parseInt(this.props.currentSlot[2])))," until the block n. ",React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"block/"+this.props.currentSlot[0],target:"_blank"},this.props.currentSlot[0])),this.props.currentSlot&&React.createElement("p",null,"Disclamer: Switching $BUIDL V1 to $buidl V2 is an irreversible action, do it at your own risk")))}});!window.preloadedScripts && (window.preloadedScripts=[]);Array.prototype.push.apply(window.preloadedScripts,['spa/bigLoader.jsx','spa/index/controller.jsx','spa/index/style.min.css','spa/index/view.jsx','spa/info/controller.jsx','spa/info/style.min.css','spa/info/view.jsx','spa/loader.jsx','spa/status/controller.jsx','spa/status/style.min.css','spa/status/view.jsx','spa/switch/controller.jsx','spa/switch/style.min.css','spa/switch/view.jsx']);